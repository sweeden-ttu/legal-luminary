{%- comment -%}
Sidebar Legal News Feed
- Displays up to 5 most recent news items from RSS feeds
- Reads from _data/news-feed.json generated by GitHub Actions
{%- endcomment -%}

{%- assign news_data = site.data.news-feed -%}

{%- if news_data and news_data.all_items and news_data.all_items.size > 0 -%}
  {%- assign recent_news = news_data.all_items | limit: 5 -%}
  
  <section class="sidebar-feed sidebar-news-feed" aria-labelledby="sidebar-news-feed-title">
    <h3 id="sidebar-news-feed-title">Legal News</h3>
    
    <ul class="sidebar-feed-list">
      {%- for item in recent_news -%}
        <li class="sidebar-feed-item">
          <a class="sidebar-feed-title" href="{{ item.link }}" target="_blank" rel="noopener noreferrer">
            {{ item.title }}
          </a>
          <div class="sidebar-feed-meta">
            <span class="news-source">{{ item.source }}</span>
            <span class="news-date">{{ item.date | date: "%b %-d, %Y" }}</span>
          </div>
          {%- if item.excerpt and item.excerpt != "" -%}
            <p class="sidebar-feed-excerpt">
              {{ item.excerpt | strip_html | truncate: 140 }}
            </p>
          {%- endif -%}
        </li>
      {%- endfor -%}
    </ul>
    
    <a class="sidebar-feed-more" href="{{ '/legal-news/' | relative_url }}">View all legal news</a>
    
    {%- if news_data.last_updated -%}
      <div class="sidebar-news-updated">
        <small>Last updated: {{ news_data.last_updated | date: "%b %-d, %Y at %-I:%M %p" }}</small>
      </div>
    {%- endif -%}
  </section>
{%- else -%}
  {%- comment -%}Silently hide if no news data available{%- endcomment -%}
{%- endif -%}
